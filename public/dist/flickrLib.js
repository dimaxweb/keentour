function FlickrLib(e){this.state={},this.logBag={},this.pagesCache={},this.options={api_key:"8e4a571bd31e66694d7d66b4b6786761",defaultQuery:"London",perPage:12,page:1,accuracy:12,photoInfo:"tags,url_sq,url_t,url_s,url_m,url_z,url_l,url_o,description",sort:"relevance",tagsMode:"all",tags:"London",format:"json",query:null,geo_context:1,text:""},this.options=$.extend(!0,this.options,e),this.options.query||(this.options.query=this.options.defaultQuery),this.setOptions(this.options)}FlickrLib.prototype.searchPhotos=function(e){var t={};t.errorMessage="",t.status="fail";var n="http://api.flickr.com/services/rest/?method=flickr.photos.search&api_key="+this.options.api_key+"&page="+this.options.page+"&sort="+this.options.sort+"&accuracy="+this.options.accuracy;this.options.tags!=""&&(n+="&tags="+this.options.tags),this.options.text!=""&&(n+="&text="+this.options.text),n=n+"&tag_mode="+this.options.tagsMode+"&per_page="+this.options.perPage+"&extras="+this.options.photoInfo+"&format="+this.options.format;try{$.getJSON(n+"&jsoncallback=?",function(n){n&&n.stat==="ok"?n&&n.photos&&n.photos.photo?(t.status="ok",t.flickrResult=n):t.status="fail":t.status="fail",e(t)}).error(function(){e(t)})}catch(r){t.errorMessage=r.toString(),t.status="fail",e(t)}},FlickrLib.prototype.setOption=function(e,t){e==="query"&&$.trim(t)===""&&(this.options.query=this.options.defaultQuery),e==="page"&&!t&&(this.options.page=1)},FlickrLib.prototype.setOptions=function(e){for(var t in e)this.setOption(t,e[t])},FlickrLib.prototype.nextPage=function(e){return this.options.page=this.options.page+1,this.searchPhotos(e)},FlickrLib.prototype.previousPage=function(e){return this.options.page=this.options.page===1?1:this.options.page-1,this.searchPhotos(e)},FlickrLib.prototype.getPage=function(e,t){return e&&!isNaN(e)?(this.options.page=e,this.searchPhotos(t)):(this.options.page=1,this.searchPhotos(t))}