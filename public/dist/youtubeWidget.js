require(["jquery","twitter_grid","jQueryUI","youTubeLib","jquery.paginate","jquery.colorbox-min","swfObject","css!paginationCSS","css!jQueryUICSS"],function(e,t){(function(e){e.widget("custom.youTubeFy",{options:{clear:null,tags:null,page:1,"max-results":20,query:"London travel"},videosContainer:null,initialQuery:null,_create:function(){try{this.initialQuery=this.options.query,this.runWidget()}catch(e){console&&console.log&&console.log(e)}},addKeyWord:function(e){this.options.query=this.initialQuery+" "+e,this.runWidget()},backToInitialState:function(){this.options.tags=this.initialQuery,this.runWidget()},_setOption:function(t,n){switch(t){case"clear":}e.Widget.prototype._setOption.apply(this,arguments)},runWidget:function(){e("#videos").empty(),this.imagesCache={},this.initilaising=!0,this.youTubeLib=new YouTubeLib(this.options);var t=this;t.videosContainer=this.element.find("#videos");var n=function(n){e(t.videosContainer).find("#noVideosFound").remove();if(n&&n.videoResult&&n.videoResult.feed&&n.videoResult.feed.entry&&n.videoResult.feed.entry.length>0){var r=t.displayData.call(t,n);t.createPaging(r)}else{e(t.videosContainer.children()).empty();var i=e('<div id="#noVideosFound" style="margin-top: 50px;margin-left: 200px">No videos found</div>').prependTo(t.videosContainer)}};this.findCreatePlayerFrame(),this.youTubeLib.searchVideos(n)},destroy:function(){e.Widget.prototype.destroy.call(this)},preloadVideoThumb:function(t,n,r,i){var s=this,o=t.url;n.hide(),n.attr("src",o),n.css({width:t.width,height:t.height}),e(n).load(function(){s.imagesCache[o]=this,e(r).hide(),e(this).fadeIn("slow"),i()})},playVideo:function(e){this.showVideo(e.media$group.yt$videoid.$t)},showVideo:function(t){swfobject.switchOffAutoHideShow(),e("#playerFrame").empty(),e("#playerFrame").append('<div id="playerArea"></div>'),this.emmbedPlayer(t)},emmbedPlayer:function(e){var t={allowScriptAccess:"always"},n={id:"myPlayer"},r="http://www.youtube.com/v/"+e;swfobject.embedSWF(r+"?version=3&enablejsapi=1&playerapiid=player1&autoplay=1&color=#96B512","playerArea","840","500","8",null,null,t,n)},findCreatePlayerFrame:function(){var t=e("#playerFrame");return t.length==0?e('<div id="playerFrame"><div id="playerArea"></div></div>').appendTo("body"):t},createPaging:function(t){var n=this,r=t.feed.openSearch$totalResults.$t/this.options["max-results"],i=this.element.find("#videoPaging");e(i).paginate({count:r<100?r:100,start:1,display:15,border:!0,text_hover_color:"#33506E",background_hover_color:"#fff",background_color:"#fff",text_color:"#33506E",images:!1,mouse:"press",onChange:function(e,t){n.goToPage(e,t)}})},goToPage:function(t,n){try{var r=this,i=e(this.element).find("#videos");e(i).addClass("contTransperensy");var s=function(e){r.displayData.call(r,e)};r.youTubeLib.getPage(t,s)}catch(o){}},displayData:function(n){var r=this,i={};if(n.status=="ok"){i=n.videoResult;var s=i.feed.entry,o=r.videosContainer;r.findCreatePlayerFrame();if(s){var u=e(this.element).find("#videos");e(u).removeClass("contTransperensy"),e(u).empty(),t.gridify({element:e(o),data:s,itemsPerRow:4,getItemContent:function(t,n,i){var s=t,o=s.media$group.media$thumbnail[0].url,u=s.title.$t.toLowerCase();u=u.length>30?u.substr(0,27)+"...":u;var a=YouTubeLib.getVideoTime(t),f=e('<div class="video-block"><a class="video-link"><img  src="'+o+'" class="thumbnail video-thumb" /><span class="video-time">'+a+"</span></a>"+"<h6>"+u+"</h6>");e(n).append(f);var l=e(n).find("a").first();e(l).colorbox({inline:!0,width:"885px",height:"600px",href:"#playerFrame",title:s.title.$t,onClosed:function(){e("#playerFrame").empty()}}),e(l).bind("click",function(t){var n=e(this).data("video");r.showVideo(n.media$group.yt$videoid.$t)}).data("video",s);var c=t.media$group&&t.media$group.media$description&&t.media$group.media$description.$t?"<p><h7>About:</h7>"+t.media$group.media$description.$t+"</p>":"";c.length>1e3&&(c=c.substring(0,500)+"...");var h=t.author&&t.author.length>0&&t.author[0].name&&t.author[0].name.$t?"<p><span>Published by :<span>"+t.author[0].name.$t+"</p>":"",p=t.published&&t.published.$tt?"<p><span>Taken on:<span>"+t.published.$t+"</p>":"",d=t.yt$statistics&&t.yt$statistics.viewCount?"<p>views count :"+t.yt$statistics.viewCount+"</p>":"";e(l).popover({title:u,placement:"top",content:"<div>"+h+d+"</div>"})}})}return i}}})})(jQuery)})